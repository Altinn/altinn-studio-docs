From 7b7b60a735a7eb68f6b18eebc8a79cf6bb276855 Mon Sep 17 00:00:00 2001
From: Andreas Balevik <andreasbalevik@gmail.com>
Date: Thu, 25 Aug 2022 16:21:58 +0200
Subject: [PATCH] Added version control for docs

---
 .../app/development/data/prefill/_index.en.md | 11 ++++++-
 layouts/shortcodes/version-selector.html      |  1 +
 layouts/shortcodes/version.html               |  4 +++
 static/css/custom.css                         | 30 ++++++++++++++++++-
 static/js/custom.js                           | 27 +++++++++++++++++
 5 files changed, 71 insertions(+), 2 deletions(-)
 create mode 100644 layouts/shortcodes/version-selector.html
 create mode 100644 layouts/shortcodes/version.html

diff --git a/content/app/development/data/prefill/_index.en.md b/content/app/development/data/prefill/_index.en.md
index 752113ee3c..39453a9635 100644
--- a/content/app/development/data/prefill/_index.en.md
+++ b/content/app/development/data/prefill/_index.en.md
@@ -2,10 +2,14 @@
 title: Prefilling data
 linktitle: Prefill
 description: How to configure prefill for an app.
-toc: true
+toc: false
 weight: 200
 ---
 
+{{% version-selector %}}
+
+{{< version id="v-1 v-2" >}}
+
 As of today, Altinn offers three methods for prefilling data in an app for a user.
 These methods can be combined freely to reach the desired result.
 
@@ -235,3 +239,8 @@ Content-Disposition: form-data; name="Endring-av-navn"
 
 --abcdefg--
 ```
+{{< /version >}}
+
+{{< version id="v-7" >}}
+Test text, new version description
+{{< /version >}}
\ No newline at end of file
diff --git a/layouts/shortcodes/version-selector.html b/layouts/shortcodes/version-selector.html
new file mode 100644
index 0000000000..b1ce054d62
--- /dev/null
+++ b/layouts/shortcodes/version-selector.html
@@ -0,0 +1 @@
+<ul id="version-selector"></ul>
\ No newline at end of file
diff --git a/layouts/shortcodes/version.html b/layouts/shortcodes/version.html
new file mode 100644
index 0000000000..1b63d9e39c
--- /dev/null
+++ b/layouts/shortcodes/version.html
@@ -0,0 +1,4 @@
+
+<div class="v-container" {{ with .Get "id" }}id="{{.}}"{{ end }}>
+    {{.Inner | markdownify }}
+</div>
\ No newline at end of file
diff --git a/static/css/custom.css b/static/css/custom.css
index 9c2ff99a5c..fb833933a3 100644
--- a/static/css/custom.css
+++ b/static/css/custom.css
@@ -1,4 +1,31 @@
 
+/* Version control for docs */
+#version-selector {
+    margin-bottom:18px;
+}
+
+#version-selector li {
+    list-style: none!important;
+    display:inline-block;
+    padding: 5px 20px;
+    border: 2px solid #0062ba;
+    margin-right:5px;
+}
+
+#version-selector li.active {
+    background-color: #0062ba;
+    color:white;
+}
+
+#version-selector li::before {
+    display: none!important;
+}
+#version-selector li:hover {
+    background-color: #0062ba;
+    color:white;
+    cursor: pointer;
+}
+
 /* External links */
 
 a[href^=http]:not([href*='altinn.no']):not([href*='basefarm.net']):not([href*='local.altinn'])::after {
@@ -383,4 +410,5 @@ figure {
     margin-top: 5px;
     font-size: 16px; }
     .a-st-iconLabel a {
-      font-size: 16px; }
\ No newline at end of file
+      font-size: 16px; }
+      
\ No newline at end of file
diff --git a/static/js/custom.js b/static/js/custom.js
index 945ce6c50d..0cb45931e3 100644
--- a/static/js/custom.js
+++ b/static/js/custom.js
@@ -13,4 +13,31 @@ $(document).ready(function() {
     if(window.location.href.match('/technology/')){
         $("body").addClass("adocs-tech");
     }
+
+    /* handles doc versions */
+    $('*[class*=v-container]').each(function() {
+        $(this).css('display', 'none')
+
+        var id = $(this).attr('id');
+        $('#version-selector').append('<li id=li-'+id+'>' + id.replace(" ", ", ") + '</li>');
+    });
+
+    $('*[class*=v-container]:first').css('display', 'block')
+    $('#version-selector li:first').addClass('active')
+
+    $('#version-selector li').click(function(e) { 
+        var idToShow = $(this).text().split(",")[0]
+
+        $('*[class*=v-container]').each(function() {
+            $(this).css('display', 'none')
+        });
+
+        $('#version-selector li').each(function() {
+            $(this).removeClass('active')
+        });
+
+        $('*[id*='+idToShow+']').css('display', 'inline-block')
+        $('li[id*='+idToShow+']').addClass('active')
+    });
+    /* end */
 });
-- 
2.28.0

