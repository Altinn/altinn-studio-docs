<mxfile host="65bd71144e">
    <diagram id="Ojr5TXfeHzHY1lrTiJDH" name="Page-1">
        <mxGraphModel dx="525" dy="583" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" background="#ffffff" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="3" value="sequenceDiagram&#xa;    autonumber&#xa;    participant User as Sluttbruker&lt;br&gt;(Altinn App UI)&#xa;    participant App as Altinn App&lt;br&gt;m/ Fiks Arkiv klient&#xa;    participant MP as Maskinporten&#xa;    participant FiksIO as Fiks IO&#xa;    participant Arkiv as Arkivsystem&lt;br&gt;m/ Fiks IO klient&#xa;&#xa;    %% --- Innsending av skjema ---&#xa;    User-&gt;&gt;App: Fyller ut og sender inn skjema&#xa;&#xa;    %% --- App forbereder sending ---&#xa;    App-&gt;&gt;App: Genererer NOARK 5 arkivmelding&lt;br&gt;+ vedlegg (XML)&#xa;&#xa;    %% --- App henter token ---&#xa;    App-&gt;&gt;MP: Hent Maskinporten-token&lt;br&gt;(for å snakke med Fiks IO)&#xa;    MP--&gt;&gt;App: Returnerer token&#xa;&#xa;    %% --- App henter nøkkel for kryptering ---&#xa;    App-&gt;&gt;FiksIO: Hent offentlig nøkkel&lt;br&gt;til mottaker&#xa;    FiksIO--&gt;&gt;App: Returnerer mottakers offentlige nøkkel&#xa;&#xa;    %% --- App krypterer og signerer ---&#xa;    App-&gt;&gt;App: Krypter meldingen med mottakers offentlige nøkkel&#xa;    App-&gt;&gt;App: Signér melding med avsenders private nøkkel&#xa;&#xa;    %% --- App sender melding ---&#xa;    App-&gt;&gt;FiksIO: Send kryptert + signert melding&lt;br&gt;m/ Maskinporten-token&lt;br&gt;+ IntegrasjonsId + Integrasjonspassord&#xa;    FiksIO--&gt;&gt;App: Mottatt/transportkvittering&#xa;&#xa;    %% --- Arkivsystem mottar ---&#xa;    Arkiv-&gt;&gt;MP: Henter Maskinporten-token&lt;br&gt;(for å autentisere mot Fiks IO)&#xa;    MP--&gt;&gt;Arkiv: Returnerer token&#xa;&#xa;    Arkiv-&gt;&gt;FiksIO: Oppretter mottakskanal (listener)&lt;br&gt;m/ token + integrasjonsid + passord&#xa;    FiksIO--&gt;&gt;Arkiv: Sender kryptert melding&#xa;&#xa;    %% --- Arkivsystem dekryptering ---&#xa;    Arkiv-&gt;&gt;Arkiv: Dekrypter med privat nøkkel&lt;br&gt;til mottaker&#xa;    Arkiv-&gt;&gt;Arkiv: Prosesserer arkivmelding&lt;br&gt;og sender videre til arkivering&#xa;&#xa;    %% --- Sluttstatus tilbake til App ---&#xa;    Arkiv-&gt;&gt;FiksIO: Sender kvittering tilbake&#xa;    FiksIO--&gt;&gt;App: Leverer kvittering (kryptert)&#xa;    App-&gt;&gt;App: Dekrypter kvittering med privat nøkkel&#xa;    App--&gt;&gt;App: Viser kvittering eller feilmelding&#xa;" style="shadow=0;dashed=0;align=left;strokeWidth=1;shape=mxgraph.mermaid.abstract.mermaid;labelBackgroundColor=#ffffff;noLabel=1;theme=default;" parent="1" vertex="1">
                    <mxGeometry x="60" y="100" width="800" height="670" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="pie title What Voldemort doesn&#39;t have?&#xa;         &quot;FRIENDS&quot; : 2&#xa;         &quot;FAMILY&quot; : 3&#xa;         &quot;NOSE&quot; : 45" style="shadow=0;dashed=0;align=left;strokeWidth=1;shape=mxgraph.mermaid.abstract.mermaid;labelBackgroundColor=#ffffff;noLabel=1;theme=default;" parent="1" vertex="1">
                    <mxGeometry x="390" y="790" width="300" height="300" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>